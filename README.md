# Project Writeup
###Problem domain
Cryptography challenges are popular in Capture the Flag (CTF) competitions and many of them involve exploiting a vulnerability in a poorly implemented RSA cryptosystem. These vulnerabilities make it possible to either factor an RSA modulus in a reasonable amount of time or compute the plaintext message directly.  Often the workflow for solving one these RSA problems involves figuring out which vulnerability is present, researching exploits for that vulnerability, and writing a program/script implementing an exploit. Assuming that the vulnerability is not revealed in the problem statement, each of these steps can take a significant amount of time. On top of that there is also the time spent debugging the exploit implementation.  

To help reduce the amount of time spent on each of these steps, we have developed an RSA vulnerabilities exploit library for CTF challenges related to RSA cryptosystems. Many commonly known exploits including Wiener's Attack, Hastad's Broadcast Attack, Common Modulus attack are already implemented for the user. In addition, various prime factorization methods each with their own special use cases are included. If the required exploit is already implemented by our library, the time required to research, code, and debug a solution is significantly reduced. If the RSA vulnerability or required exploit is not immediately known, a user could run a battery of exploits against the provided ciphertexts and RSA key data in an attempt to uncover more information. The library can also be used to test CTF challenges for correctness, thus reducing the amount time required to implement solution scripts. 

###CTF Problem examples:

CTF Problem: Hack You 2014 - CRYPTONET:
We have intercepted communication in a private network. It uses a strange protocol based on RSA cryptosystem.
Can you still prove that it is not secure enough and get the flag?

Analysis of server RSA implementation and capture file:
* Integer encoded plain-text message is less than modulus
* Public exponent(e) remains constant (17), but modulus(N) varies
* 19 ciphertexts are captured

This cryptosystem is vulnerable to Hastad's Broadcast Attack. Hastad's attack uses the Chinese Remainder Theorem to recover the plaintext message given a list of ciphertexts, moduli, and the public exponent e. It is guaranteed to succeed if the same plaintext message was used to generate all ciphertexts, the public exponent e is the same in all encryptions, the number of ciphertexts is greater than or equal to e, all of the moduli are greater than the plaintext, all of the moduli are unique, and all of the moduli are coprime (if they are not coprime then they share a common factor and another exploit can be used). Ideally, all a user of our library would need to do for this problem is extract the ciphertexts, moduli, and public exponent from the packet capture and provide that information to our library. Our library would run through a list of exploits that includes Hastad's attack and would recover the plaintext. If the user realizes that the correct exploit is Hastad's attack, they could specify the correct exploit and not have to wait for all of the other exploits to finish executing.


```
import RSAExploits

rsadata_list = []
for i in range(0, 19)
rsadata_list.append(RSA_Data((N[i],e[i]), (c[i], idnum=1)))
if Hastad().run(rsadata_list):
	flag = hex2string(rsadata_list.get_m())
	if is_printable(flag):
		print "Decrypted text: ", flag
	else:
		print "Decrypted text is not printable."
```

####CTF Problem: Hack.lu 2014 - Wiener:
It’s gold rush time! The New York Herald just reported about the Californian gold rush. We know a sheriff there is hiring guys to help him fill his own pockets. We know he already has a dreadful amount of gold in his secret vault. However, it is protected by a secret only he knows. When new deputies apply for the job, they get their own secret, but that only provies entry to a vault of all deputy sheriffs. No idiot would store their stuff in this vault. But maybe we can find a way to gain access to the sheriff’s vault? Have a go at it:
nc wildwildweb.fluxfingers.net 1426

Analysis of server RSA implementation:
* Public key is accessible through server
* The size of the private exponent(d) in bits is around 1/5 of the modulus

The name of the problem gives it away, but this cryptosystem is vulnerable to Wiener's Attack. Wiener's attack is able to recover the private exponent d when d < N^(1/4). Once again, our library could be used to reduce the amount of time needed to write a script that uses Wiener's attack to recover the private key and decrypt the message. 

```
import RSAExploits
rsadata = RSA_Data((N,e), (c))
if Wiener.run([rsadata]):
	plaintext = rsadata.decrypt()
	flag = hex2string(plaintext)
	if is_printable(flag):
		print "Decrypted text: ", flag
	else:
		print "Decrypted text is not printable."
else:
	print "Wiener Attack can't be executed!"
```

###Existing Research
##### 1. Twenty Years of Attacks on the RSA Cryptosystem
This paper provides a survey of many potential vulnerabilities in the RSA cryptosystem and describes exploits for each. Among the discussed exploits are common modulus, Wiener's attack, Boneh Durfee attack, Hastad's Broadcast atack, and Franklin-Reiter Related Message attack. We used this paper as a basis for determining which exploits to include in our library. 
#####2. https://github.com/pablocelayes/rsa-wiener-attack
Github user pablocelayes has written a collection of python scripts that implement Wiener's
attack on RSA. When the private exponent(d) is less than N(0:25)=3, Wiener's attack can use continued fraction approximations to recover d.
#####3 https://github.com/mimoo/RSA-and-LLL-attacks
Github user mimoo appears to have written a collection of sage scripts that implement LLL
lattice based attacks on RSA. LLL lattice reduction is an algorithm created by Coppersmith
that can be used for finding roots of polynomial equations.

###Our Work (Delta)
We can't find a single library, that present RSA exploits in coherent fashion, so that a particular set of RSA elements can be tested for various vulnerabilities. Our library achieves that by integrating all RSA attacks using RSA_Data object, which makes sure attacks having different input and output signature can be tested with the same set of objects.
Such an architecture, makes it much easier to verify RSA keys for set of attacks. Moreover, any other RSA attack can also be easily integrated into the library.

The library combines various RSA attacks, some are vulnerability based, such as Wiener attack. Some are completely based on factorization, such as Quadratic Sieve. Our purpose is to assimilate all known methods of of attacking RSA in one coherent library.

Mathematical intensive sage based exploit classes can also be easily added in the library without any extra effort. Sage based exploits requires Sage to be pre-installed in the system. If Sage is not installed, other python based scripts work fine.

###Problem Demo
