# Project Writeup
###Problem domain
The project covers fast and efficient RSA vulnerabilities exploit library for CTF challenges related to RSA cryptosystems. In RSA attacks, the primary challenge is to find prime numbers (p,q). There are many attacks possible from basic gcd calculation to advance attacks, e.g. Wiener Attack, Hastad's Broadcast Attack, etc. The vulnerability in CTF challenge can be identified and the particular attack can be executed to retrieve prime numbers and finally decrypt the secret.
Often cryptography challenges require scripting in python to exploit various vulnerabilities. During the CTF competition, the primary goal is to produce a working code, while code efficiency and correctness  are of less concern. Usually, solving an RSA cryptography challenge requires coding a simple RSA implementation or using existing libraries. The coding effort and verification effort significantly reduce, if a common framework for RSA implementation and exploits are provided. The framework can be used directly for discovering/checking, and executing the exploit using inbuilt classes and functions.
Also, some times RSA elements are vulnerable to more more than one RSA exploit, which are not known. Applying various exploits on a set of RSA keys might lead to fast retrieval of secret. The library can also be used for testing CTF challenges for correctness.

###CTF Problem examples:

CTF Problem: Hack You 2014 - CRYPTONET:
We have intercepted communication in a private network. It uses a strange protocol based on RSA cryptosystem.
Can you still prove that it is not secure enough and get the flag?
Explanation:
Analysis of server RSA implementation and capture file:
* Integer encoded plain-text message is less than modulus
* Public exponent(e) remains constant, but modulus(N) varies
* 19 cipher texts are captured

The cryptosystem is vulnerable to Håstad's Broadcast Attack.
By observing above three points, Chinese Remainder Theorem(CRT) seems a viable option to recover message.
Chinese remainder theorem can be applied, when the number of cipher-text(k) >= public exponent(e).

```
import RSAexploits
RSAObject r[19]
for i in range(0, 19)
r[i] = Initialize_RSA(N[i],e[i],s[i])
	flag^e = Execute_CRT(r)
	flag = root(flag^e, e)
	if check_Printable(flag):
		print "Decrypted text: ", flag
	else:
		print "Decrypted text is not printable."
```

####CTF Problem: Hack.lu 2014 - Wiener:
It’s gold rush time! The New York Herald just reported about the Californian gold rush. We know a sheriff there is hiring guys to help him fill his own pockets. We know he already has a dreadful amount of gold in his secret vault. However, it is protected by a secret only he knows. When new deputies apply for the job, they get their own secret, but that only provies entry to a vault of all deputy sheriffs. No idiot would store their stuff in this vault. But maybe we can find a way to gain access to the sheriff’s vault? Have a go at it:
nc wildwildweb.fluxfingers.net 1426

Analysis of server RSA implementation:
* Public key is accessible through server
* Private exponent(d) bit size is around 1/5 of modulus

The cryptosystem seems vulnerable to Wiener Attack, as d is significantly smaller than modulus.

```
import RSAexploits
RSAObject r
r = Initialize_RSA(N,e)
if Check_WienerAttack(r) == True:
	r.primes = Execute_WienerAttack(r)
	r.d = r.generate_d()
	r.plaintext = r.decrypt(s)
	if check_Printable(r.plaintext):
		print "Decrypted text: ", r.plaintext
	else:
		print "Decrypted text is not printable."
else:
	print "Wiener Attack can't be executed!"
```

###Existing Research
The goal of the exploit library is to present ready to use, exploit functions in a streamlined
fashion. There are few implementations/paper covering various RSA exploits.
##### 1. Twenty Years of Attacks on the RSA Cryptosystem
This paper provides a survey of many potential vulnerabilities in the RSA Cryptosystem and describes attack implementations that could exploit them. Many of these vulnerabilities/attacks is implemented in our RSA library. These include common moduli, low private exponent (Wiener's attack), low public exponent, and Coppersmith's attacks.
#####2. https://github.com/pablocelayes/rsa-wiener-attack
Github user pablocelayes has written a collection of python scripts that implement Wiener's
attack on RSA. When the private exponent(d) is less than N(0:25)=3, Wiener's attack can use continued fraction approximations to recover d.
#####3 https://github.com/mimoo/RSA-and-LLL-attacks
Github user mimoo appears to have written a collection of sage scripts that implement LLL
lattice based attacks on RSA. LLL lattice reduction is an algorithm created by Coppersmith
that can be used for finding roots of polynomial equations.

###Our Work (Delta)
We can't find a single library, that present RSA exploits in coherent fashion, so that a particular set of RSA elements can be tested for various vulnerabilities. Our library achieves that by integrating all RSA attacks using RSA_Data object, which makes sure attacks having different input and output signature can be tested with the same set of objects.
Such an architecture, makes it much easier to verify RSA keys for set of attacks. Moreover, any other RSA attack can also be easily integrated into the library.

The library combines various RSA attacks, some are vulnerability based, such as Wiener attack. Some are completely based on factorization, such as Quadratic Sieve. Our purpose is to assimilate all known methods of of attacking RSA in one coherent library.

Mathematical intensive sage based exploit classes can also be easily added in the library without any extra effort. Sage based exploits requires Sage to be pre-installed in the system. If Sage is not installed, other python based scripts work fine.

###Problem Demo
