
from RSAExploits.exploits import wiener
from Crypto.PublicKey import RSA

def set_RSAobj(n,e,d=None,p=None,q=None):
	if n != None and e != None and d == None and p == None and q == None:
		key = RSA.construct((n, e))
	elif n != None and e != None and d != None and p == None and q == None:
		key = RSA.construct((n, e, d))
	elif n != None and e != None and d != None and p != None and q == None:
		key = RSA.construct((n, e, d, p))
	elif n != None and e != None and d != None and p != None and q != None:
		key = RSA.construct((n, e, d, p, q))
	
	return key 	



key = RSA.generate(1024)


k = set_RSAobj(key.n,key.e,key.d)

print wiener.check(k.n,k.e)

