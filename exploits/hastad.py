#!/usr/bin/env python

#import gmpy

from RSAExploits import util

def execute(keys, cs):
        '''
        ns: array of n
        e: public exponent
        cs: array of cipher text
        '''
	ns = []
	for key in keys:
        	ns.append(key.n)
        e = keys[0].e
	return decrypt(ns,cs,e)

def decrypt(ns,cs,e):
	s = util.CRT(ns, cs)
	pt = util.int_nthroot(s, e)
	if pt is not None:
		return pt
	else:
		print "Cannot find %dth root of %s" % (e, hex(s))
		return None

        
