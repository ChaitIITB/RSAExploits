import sys
import subprocess

attackList = {'wiener':('Ne','pq'), 
	      'fermat':('N','pq'),
	      'hastad':('NC','P'),
	      'coppersmith':('NE','pq')} 

sageList = ['coppersmith','factoring'] 

def execute(attack, rsadata, extras=None):
	if attack not in attackList:
		print "Attack exploit not present."
		sys.exit(1)
	if attack in sageList:
		script_locals = dict()
		execfile("RSAExploits/sagetest.py", dict(), script_locals)
		print(script_locals["ret"])
