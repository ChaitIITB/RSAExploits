sage_present = 1
try:
    from sage.all_cmdline import *    
except ImportError:
    sage_present = 0

exploit_classes = []

def init():
    global exploit_classes 
    global sage_present

    ### Attacks that do not require sage
    from RSAExploits.exploits.common_modulus import Common_Modulus
    exploit_classes.append(Common_Modulus())

    ### Attacks that require sage
    if sage_present:
        from RSAExploits.exploits.common_modulus_factor import Common_Modulus_Factor
        exploit_classes.append(Common_Modulus_Factor())

def attack(ciphertexts):
    for exploit in exploit_classes:
        exploit.run(ciphertexts)

