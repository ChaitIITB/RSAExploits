
from RSAExploits.RSA_Ciphertext import RSA_Ciphertext 

sage_present = 1
try:
    from sage.all_cmdline import *    
except ImportError:
    sage_present = 0

exploit_classes = []

def init():
    global exploit_classes 
    global sage_present

    ### Attacks that do not require sage
    from RSAExploits.exploits.common_modulus import Common_Modulus
    exploit_classes.append(Common_Modulus())

    ### Attacks that require sage
    if sage_present:
        from RSAExploits.exploits import common_modulus_factor as common_modulus_factor
        from RSAExploits.exploits import simple_CRT as simple_CRT

def attack(ciphertexts):
    for exploit in exploit_classes:
        exploit.run(ciphertexts)

